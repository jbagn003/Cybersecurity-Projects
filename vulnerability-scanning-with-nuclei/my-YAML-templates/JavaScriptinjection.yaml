id: javascript-injection-check  # Unique ID for this Nuclei template

info:
  name: JavaScript Injection Detection
  author: Jean Bagnis
  severity: high
  description: Checks for JavaScript injection vulnerability on a specific page.
  tags: javascript,injection

requests:
  - method: GET  # Sends a GET request to the target application
    path:
      # Attempts to inject a JavaScript payload through a user-controlled parameter
      - "{{BaseURL}}/mutillidae/index.php?page=password-generator.php&username=<script>alert(1)</script>"

    matchers:
      # Confirms the vulnerability by checking if the injected script is reflected in the response
      - type: word
        words:
          - "<script>alert(1)</script>"
        part: body

      # Secondary check to ensure the JavaScript function itself appears in the response
      - type: word
        words:
          - "alert(1)"
        part: body
